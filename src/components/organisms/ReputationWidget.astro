---
import Container from '../atoms/Container.astro';
import Heading from '../atoms/Heading.astro';
import Paragraph from '../atoms/Paragraph.astro';
import Link from '../atoms/Link.astro';

interface Award {
  src: string;
  alt?: string;
}
export interface Copy {
  title: string;
  marketText: string;
  marketLinkText?: string;
  marketLinkHref?: string;
  prize?: string;
  awards?: Award[];
}

interface Props {
  id?: string;
  copy: Copy;
  class?: string;
}
const {
  id = 'reputation-widget',
  copy,
  class: className = '',
} = Astro.props as Props;
---

<section
  id={id}
  class:list={['hg-ReputationWidget', className]}
  aria-labelledby={`${id}-title`}
>
  <Container maxWidth="lg" padding="none">
    <div class="inner">
      <Heading
        id={`${id}-title`}
        level={2}
        size="4xl"
        align="center"
        class="title">{copy.title}</Heading
      >

      <Paragraph size="sm" class="market">
        {copy.marketText}{' '}
        {
          copy.marketLinkHref && (
            <Link
              href={copy.marketLinkHref}
              target="_blank"
              rel="noopener noreferrer"
            >
              {copy.marketLinkText || 'Source'}
            </Link>
          )
        }
      </Paragraph>

      {
        copy.prize && (
          <p class="prize" aria-label="Primary award">
            <span class="laurel" aria-hidden="true" />
            <span class="prize-text">{copy.prize}</span>
            <span class="laurel" aria-hidden="true" />
          </p>
        )
      }

      {
        copy.awards && copy.awards.length > 0 && (
          <div class="awards" role="list" aria-label="Awards">
            {copy.awards.map((a) => (
              <div class="awards-item" role="listitem">
                <img src={a.src} alt={a.alt || ''} loading="lazy" />
              </div>
            ))}
          </div>
        )
      }
    </div>
  </Container>
</section>

<style>
  .hg-ReputationWidget {
    padding: 0;
    background: var(--color-background-body);
  }

  /* Live section has no grey inner container or rounded background */
  .hg-ReputationWidget .inner {
    padding: 0;
  }

  .title {
    margin: 0 0 var(--space-lg) 0;
    color: var(--color-text-heading);
    line-height: var(--line-height-54px);
  }

  /* Live style: underlined market statement */
  .market {
    text-align: center;
    margin: 0;
    font-size: var(--font-size-24);
    font-weight: var(--font-weight-semibold);
    display: inline-block;
  }

  .prize {
    margin: 0;
    text-align: center;
    color: var(--color-text-heading);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-md);
  }

  .prize-text {
    display: inline-block;
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-black);
  }

  .prize .laurel {
    width: var(--space-lg);
    height: var(--space-lg);
    display: inline-block;
    background: currentcolor;
    /* stylelint-disable-next-line property-no-vendor-prefix */
    -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23000000"><path d="M7.5 3C5 6 4 9 4 12s1 6 3.5 9c.7-.8 1.3-1.6 1.8-2.5C7.8 16.9 7 14.5 7 12s.8-4.9 2.3-6.5C8.8 4.6 8.2 3.8 7.5 3zm9 0c-.7.8-1.3 1.6-1.8 2.5C16.2 7.1 17 9.5 17 12s-.8 4.9-2.3 6.5c.5.9 1.1 1.7 1.8 2.5 2.5-3 3.5-6 3.5-9s-1-6-3.5-9z"/></svg>')
      center / contain no-repeat;
    mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23000000"><path d="M7.5 3C5 6 4 9 4 12s1 6 3.5 9c.7-.8 1.3-1.6 1.8-2.5C7.8 16.9 7 14.5 7 12s.8-4.9 2.3-6.5C8.8 4.6 8.2 3.8 7.5 3zm9 0c-.7.8-1.3 1.6-1.8 2.5C16.2 7.1 17 9.5 17 12s-.8 4.9-2.3 6.5c.5.9 1.1 1.7 1.8 2.5 2.5-3 3.5-6 3.5-9s-1-6-3.5-9z"/></svg>')
      center / contain no-repeat;
    color: var(--color-text-heading);
  }

  .awards {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--space-lg);
  }

  .awards-item img {
    display: block;
    height: var(--size-image-height-70);
    width: auto;
  }

  @media (--bp-sm) {
    .hg-ReputationWidget .inner {
      padding: var(--space-xl) var(--space-md);
    }

    .awards {
      gap: var(--space-md);
    }
  }
</style>
